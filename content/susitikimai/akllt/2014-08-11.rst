Pythond dirbtuvės 2014-08-11
############################

:date: 2014-08-11
:modified: 2014-08-11
:tags: akl.lt
:slug: susitikimai/akllt/2014-08-11
:authors: sirex


Vaizdo įrašas:

    https://plus.google.com/events/cni37fvvcgqa1d9i54ldlg6jl8s


Keletas pastabų, dėl vietų, kuriose buvome užstrigę.

Problema, kurios niekaip negalėjome įveikti su Django 1.7c2 versija. Mes
buvome nurodę tokį nustatymą ``buildout.cfg`` faile::

    find-links         https://www.djangoproject.com/download/1.7c2/tarball/

Pasirodo, nuo žioplumo vaistų nėra... :)

Teisingas URL adresas yra toks::

    find-links         https://www.djangoproject.com/download/1.7c2/tarball/#egg=Django-1.7c2

Tai dokumentuota čia:

    https://pythonhosted.org/setuptools/easy_install.html#packaging-others-projects-as-eggs

Kadangi zc.buildout tiesiogiai naudoja setuptools, o setuptools turi
tokį įrankį easy_install, tai tokio pobūdžio klaidas galima testuoti
taip::

    bin/easy_install --find-links "https://www.djangoproject.com/download/1.7c2/tarball/#egg=Django-1.7.c2" Django==1.7.c2

Tokiu būdu nereikės redaguoti buildout.cfg ir kas kart leisti
bin/buildout.

Pataisymas: https://github.com/python-dirbtuves/akl.lt/commit/64e678d16b7cc6813125665e6901e27d6fb0c79e



Antra problema, kurios nesugebėjome išspręsti - src katalogas.

Jei kodas guli kokiame nors kataloge, būtina nurodyti package_dir
argumentą, o find_packages pirmas argumentas taip pat turi būti
katalogas, kuriame guli kodas:

.. code-block:: python

    package_dir={'': 'src'},
    packages=find_packages('src', exclude=['contrib', 'docs', 'tests*']),

Tai dokumentuota čia:

    https://docs.python.org/2.7/distutils/setupscript.html#listing-whole-packages
    https://pythonhosted.org/setuptools/setuptools.html#using-find-packages

Papildomai, jei buildout.cfg konfigūracijoje nurodomas develop, tai
nereiškia, kad jis bus pridėtas prie sys.path generuojant skriptus. Kad
prie sys.path būtų pridedamas develop kelias, reikia nurodyti eggo
vardą, prie eggs parametro::

    eggs =
        ipython
        akl.lt

    [ ... ]

    [django]
    recipe = djangorecipe
    eggs = ${buildout:eggs}

    [ ... ]

Pataisymas: https://github.com/python-dirbtuves/akl.lt/commit/f5aabc09cf77f386adec97561ac6e61d45ff963c



Visą tai sutvarkius, projektas pasileidžia sklandžiai ir be hackų.

